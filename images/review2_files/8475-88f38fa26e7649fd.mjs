(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[8475,51798],{509860:(e,t,o)=>{o.r(t),o.d(t,{default:()=>l});var n=o(567831),s=o(794230),r=o(107193),i=o(704115),c=o(6637);const a={open(e){var t;const o=(l=e,a._validParams.reduce(((e,t)=>(l&&Object.prototype.hasOwnProperty.call(l,t)&&(e[t]=l[t]),e)),{}));var l;const d=a._getDialogType(e),u=a.generateFbRef(null!==(t=e.unauthId)&&void 0!==t?t:""),p=e.object_type&&e.object_id&&"feed"===d;let w=(0,n.Z)(e.path);const h=(0,i.Z)();if(h.ptrf&&(w=(0,s.Z)(w,{ptrf:h.ptrf})),p&&(w=(0,s.Z)(w,{fb_ref:u})),o.method=d,"feed"===o.method){const t=a.getWindowOptions(e.width||580,e.height||400);let n="http://www.facebook.com/sharer/sharer.php?u="+w;o.picture&&(n+="&picture="+o.picture),o.name&&(n+="&title="+o.name),o.description&&(n+="&description="+o.description),o.caption&&(n+="&caption="+o.caption),window.open(encodeURI(n),"sharer",t)}else"send"===o.method?o.link=w:"share"===o.method&&(o.href=w),(0,r.default)((t=>{t.getLoginStatus((()=>{if("send"===o.method){t.ui(o);let n,s=10;const r=setInterval((()=>{n=function(){if(!document)return;const e=Array.from(document.querySelectorAll(".fb_dialog_iframe iframe"));if(!e.length)return;if(1===e.length)return e[0];const t=e.splice(0,e.length-1);for(let o=0;o<t.length;o+=1){const e=t[o].parentNode;e&&e.removeChild(t[o])}return e[0]}(),!n&&s||(clearInterval(r),n&&a.executeMessengerCallback(n,e.callback)),s-=1}),1e3)}else"share"===o.method&&t.ui(o,(t=>{p&&t&&!t.error_message&&c.Z.create("LogFacebookFeedShare",{object_type:e.object_type,object_id:e.object_id,fb_ref:u}).callCreate({showError:!1}),e.callback&&e.callback(t)}))}))}),e.viewer)},_validParams:["description","name","picture","to","href","caption","display"],_validOptions:["send","feed","share"],executeMessengerCallback(e,t){let o=10;const n=setInterval((()=>{"0px"!==e.style.width&&o||(clearInterval(n),e.style.width="575px"),o-=1}),1e3);t&&t()},generateFbRef(e){let t="";for(;t.length<20;)t+=Math.floor(65535*Math.random()).toString(16);return e+":"+t},_getDialogType:e=>a._validOptions.includes(e.type)?e.type:"feed",getWindowOptions(e,t){const o=e||580,n=t||400,s=window.screen.width,r=window.screen.height;return"scrollbars=yes,resizable=yes,toolbar=no,location=yes,width="+o+",height="+n+",left="+Math.round((s-o)/2)+",top="+(r>n?Math.round((r-n)/2):0)}},l=a},994302:(e,t,o)=>{o.d(t,{Z:()=>w,w:()=>h});var n=o(231486);var s=o(643913),r=o(966113),i=o(226198),c=o(826067),a=o(957161);let l;const d=async(e,t,o,r)=>{const a=(0,c.mB)(e);if(a.state&&a.code&&a.state===o){l&&!l.closed&&l.close();try{const e=await fetch("/oauth/line/verify",{headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8","x-csrftoken":"undefined"!=typeof window?`${String(n.U2(i.fS))}`:""},method:"POST",body:(0,s.Z)({code:a.code,redirect_uri:t})}),o=await e.json(),{id_token:c,access_token:l}=o;c&&l?r.success({line_id_token:c,line_access_token:l}):r.error(new Error("no token"))}catch(d){r.error(d)}}},u=(e,t,o,n)=>{e.isTrusted&&e.origin===window.location.origin&&e.data&&d(String(e.data),t,o,n)},p=(e,t,o,n)=>{if(e.isTrusted&&e.url.startsWith(window.location.origin)&&"lineOAuthOneTimeCode"===e.key){const e=(0,a.qn)("lineOAuthOneTimeCode");e&&d(e,t,o,n)}};function w(e,t){const o=function(e=5){const t="abcdefghijklmnopqrstuvwxyz1234567890";return new Array(e).fill("").map((()=>t[Math.floor(Math.random()*t.length)])).join("")}(10),n=`${window.location.origin}/oauth/line/redirect`;window.addEventListener("message",(t=>u(t,n,o,e))),window.addEventListener("storage",(t=>p(t,n,o,e))),l=window.open(`https://access.line.me/oauth2/v2.1/authorize?response_type=code&client_id=${r.Z.settings.LINE_CLIENT_ID}&redirect_uri=${encodeURIComponent(n)}&state=${o}&ui_locales=${t}&scope=profile%20openid%20email`,"_blank")}function h(){window.removeEventListener("message",u),window.removeEventListener("storage",p),(0,a.L_)("lineOAuthOneTimeCode"),l&&!l.closed&&l.close()}},572752:(e,t,o)=>{function n(e){return`${e.userAgent.isMobile?"mobile":"desktop"}.${e.country}.${e.userAgent.platform}.${e.userAgent.browserName}`.replace(/ /g,"_")}o.d(t,{Z:()=>n})},808475:(e,t,o)=>{o.d(t,{k:()=>y});var n=o(667294),s=o(702664),r=o(509860),i=o(6637),c=o(994302),a=o(124237),l=o(572752),d=o(966113),u=o(83969),p=o(867820);async function w(e){await(0,u.Px)();const t=function(){if("undefined"==typeof window)return null;const e=window.google;return e&&e.accounts&&e.accounts.oauth2}();if(t){t.initCodeClient({client_id:d.Z.settings.GPLUS_CLIENT_ID,scope:"https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile",ux_mode:"popup",callback:e}).requestCode()}}function h(){}let f;Object.assign(h.prototype,{optionsForNetwork:{},connect({i18n:e,network:t,options:n,requestContext:s,viewer:r}){if(n=Object.assign({},{success(){},error(){},complete(){}},n),(0,p.My)(`auth_web.social_connect.${t}.${(0,l.Z)(s)}`),n.rerequest_facebook_email)Promise.resolve().then(o.bind(o,107193)).then((({default:e})=>{e((e=>{e.login((e=>{var t;const o=e.authResponse;let s,r;o&&(s=o.grantedScopes,s=s?s.split(","):[],r=o.userID);const i=null===(t=s)||void 0===t?void 0:t.find((e=>"email"===e)),c={id:r};"connected"===e.status&&i?n.success(c):n.error(c),n.complete()}),{scope:"email",auth_type:"rerequest",return_scopes:!0})}),r)}));else if("gplus"===t||"google"===t)this.connectGoogle(n);else if("line"===t){const{locale:e}=s;(0,c.Z)(n,e)}else Promise.resolve().then(o.bind(o,509860)).then((({default:o})=>{const s=n.windowOptions||o.getWindowOptions(),r=window.open("/connect/"+t+"/","",s);if(!r)return a.Z.showError(e._('You must enable popups!', ' - ', ' -- ')),void n.error({network:t,alertedUpstream:!0});const i=setInterval((()=>{r.closed&&(clearInterval(i),this.handleComplete({network:t,error_message:"Window closed."}))}),1e3);this.optionsForNetwork=Object.assign(this.optionsForNetwork,{[t]:n})}))},connectGoogle(e){(0,p.My)("auth_web.social_connect.google.migration"),w((t=>{e.success({one_time_code:t.code,redirect_uri:"postmessage"})}))},complete(e){this.handleComplete(e)},handleComplete(e){const t=e.network;if("facebook"===t){const t=e.id;t&&"string"!=typeof t&&(e.error_message="Facebook id must be of string type")}if(this.optionsForNetwork[t]){const o=this.optionsForNetwork[t];this.optionsForNetwork[t]=null,e.error_message?o.error(e):o.success(e),o.complete()}}}),Object.assign(h,{instance:()=>(f||(f=new h),f)}),window.addEventListener("message",(e=>{const t=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"");e.origin===t&&e.data&&"social-connect-complete"===e.data.type&&h.instance().complete(e.data)}));const _=h;var g=o(19121),m=o(414327),b=o(780280),v=o(79830);class k{constructor({invalidateResource:e,requestContext:t,viewer:o}){this.getUserId=()=>o.isAuth?o.id:"",this.getUsername=()=>o.isAuth?o.username:"",this.isLimitedLogin=()=>o.isLimitedLogin,this.invalidateResource=e,this.requestContext=t,this.viewer=o}handleConnect(e,t,o,n){if(t&&!this.isLimitedLogin()){const s={success:function(n){const s={network:e,data:n};this._internalConnectNetwork(t,s,o)}.bind(this),error(e){o.error&&o.error(e)},complete(){"line"===e&&(0,c.w)(),o.complete&&o.complete()},windowOptions:void 0};"dropbox"===e?s.windowOptions="width=600,height=800":"instagram"===e?s.windowOptions=r.default.getWindowOptions(580,580):"etsy"===e?s.windowOptions=r.default.getWindowOptions(580,775):"youtube"===e&&(s.windowOptions=r.default.getWindowOptions(605,640)),this._externalConnectNetwork(e,t,s,n)}else{const n={network:e};this._internalConnectNetwork(t,n,o)}}updateConnectStatus(){const e={user_id:this.getUserId(),username:this.getUsername(),field_set_key:"social_connect"};this.invalidateResource("UserResource",e);i.Z.create("UserResource",e).callGet()}_externalConnectNetwork(e,t,o,n){t?_.instance().connect({network:e,options:o,i18n:n,requestContext:this.requestContext,viewer:this.viewer}):o.success&&o.success({})}_internalConnectNetwork(e,t,o){const n=i.Z.create("UserSocialNetworkResource",t);(e?n.callCreate():n.callDelete()).then((e=>{this.updateConnectStatus(),o.success&&o.success(e)}),(e=>{o.error&&e instanceof Object&&o.error(e)})).finally((()=>{o.complete&&o.complete()}))}_getResourceNameForNetworkFriends(e){let t=null;switch(e){case v.vq:t="UserFacebookFriendsResource";break;case v.Ib:t="UserTwitterFriendsResource";break;case v.Tr:t="UserGmailFriendsResource";break;case v.lA:t="UserMicrosoftFriendsResource";break;default:return}return t}pollForFriends(e,t){const o=(t=t||{}).resourceOptions||{},n=this._getResourceNameForNetworkFriends(e);if(!n)return;const s=i.Z.create(n,o);s.callGet({showError:!1}).then((()=>{const e=t.success;e&&e(s)}),(o=>{if(110===o.api_error_code)setTimeout((()=>{this.pollForFriends(e,t)}),1e3);else{const e=t.error;e&&e()}}))}}function y(){const e=(0,s.useDispatch)(),t=(0,b.B)(),o=(0,g.Z)();return(0,n.useMemo)((()=>new k({invalidateResource:(t,o)=>e((0,m.jB)(t,o)),requestContext:t,viewer:o})),[e,t,o])}},107193:(e,t,o)=>{o.r(t),o.d(t,{default:()=>d});var n=o(935879),s=o(713930),r=o(6637),i=o(966113),c=o(867820);let a=!1;const l=(e,t,o="en-US",d)=>{d&&(0,c.dy)({event:"load_script_start",provider:"facebook"}),(0,s.Z)((0,n.Z)(o),"FACEBOOK").then((()=>{d&&(0,c.dy)({event:"load_script_success",provider:"facebook"});const o=window.FB;o?(a||(d&&(0,c.dy)({event:"initialize_library",provider:"facebook"}),o.init({appId:i.Z.settings.FACEBOOK_API_KEY,status:!0,version:"v2.2"}),FB.Event.subscribe("auth.statusChange",(()=>{(e=>e.isAuth&&!!e.facebookId&&!e.isLimitedLogin)(t)&&l((e=>{if(!e.getUserID())return;const t=e.getAccessToken();if(t){r.Z.create("UserSocialNetworkResource",{facebook_token:t}).callUpdate({showError:!1})}}),t)})),a=!0,window.fb_init=2),e(o)):d&&(0,c.dy)({event:"global_object_not_found",provider:"facebook"})})),window.fb_init=1},d=l}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/8475-88f38fa26e7649fd.mjs.map